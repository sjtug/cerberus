"use strict";(self.webpackChunkcerberus_pow=self.webpackChunkcerberus_pow||[]).push([[840],{381:(e,t,s)=>{const n=s.p+"c58aa3c564e6e6960183.wasm?raw";class a{static state={baseURL:"",version:"unknown"};static elements={title:null,mascot:null,status:null,metrics:null,message:null,progressContainer:null,progressBar:null};static initialize(e){this.state={...this.state,...e},this.elements={title:document.getElementById("title"),mascot:document.getElementById("mascot"),status:document.getElementById("status"),metrics:document.getElementById("metrics"),message:document.getElementById("message"),progressContainer:document.getElementById("progress-container"),progressBar:document.getElementById("progress-bar")}}static setState(e,t={}){switch(e){case"checking":this.setChecking(t);break;case"success":this.setSuccess(t)}}static setChecking(e){this.elements.title.textContent=e.title||"Making sure you're not a bot!",this.elements.mascot.src=`${this.state.baseURL}/static/img/mascot-puzzle.png?v=${this.state.version}`,this.elements.status.textContent=e.status||"Calculating...",this.elements.progressContainer.classList.remove("hidden"),this.setCheckingProgress(e.progress,e.metrics,e.message)}static setCheckingProgress(e,t,s){void 0!==e&&(this.elements.progressBar.style.width=`${e}%`),void 0!==t&&(""===t?this.elements.metrics.classList.add("hidden"):(this.elements.metrics.classList.remove("hidden"),this.elements.metrics.textContent=t)),void 0!==s&&(this.elements.message.textContent=s)}static setSuccess(e){this.elements.title.textContent="Success!",this.elements.mascot.src=`${this.state.baseURL}/static/img/mascot-pass.png?v=${this.state.version}`,this.elements.status.textContent=e.status||"Done!",this.elements.metrics.textContent=e.metrics||"Took ?, ? iterations",this.elements.message.textContent=e.message||"",this.elements.progressContainer.classList.add("hidden")}}(async()=>{const e=JSON.parse(document.getElementById("challenge").textContent),t=JSON.parse(document.getElementById("difficulty").textContent),o=JSON.parse(document.getElementById("baseURL").textContent),i=JSON.parse(document.getElementById("version").textContent),c=JSON.parse(document.getElementById("nonce").textContent),r=JSON.parse(document.getElementById("ts").textContent),l=JSON.parse(document.getElementById("signature").textContent);a.initialize({baseURL:o,version:i}),a.setState("checking",{metrics:`Difficulty: ${t}, Speed: calculating...`,message:""});const m=Date.now();let d=0;const u=Math.pow(16,-t),h=`${e}|${c}|${r}|${l}|`,{hash:p,nonce:g,data:C}=await async function(e,t=5,a=null,o=null,i=navigator.hardwareConcurrency||1){return new Promise(((c,r)=>{console.debug("fast algo");const l=[],m=()=>{l.forEach((e=>e.terminate())),null!==a&&(a.removeEventListener("abort",m),a.aborted&&(console.log("PoW aborted"),r(new Error("PoW aborted"))))};null!==a&&a.addEventListener("abort",m,{once:!0}),(async()=>{const a=await(await fetch(n)).arrayBuffer();for(let n=0;n<i;n++){let d=new Worker(new URL(s.p+s.u(665),s.b),{type:void 0});d.onmessage=e=>{"number"==typeof e.data?o?.(e.data):(m(),c(e.data))},d.onerror=e=>{m(),r(e)},d.postMessage({wasmModule:a,data:e,difficulty:t,nonce:n,threads:i}),l.push(d)}})()}))}(h,t,null,(e=>{const s=Math.pow(1-u,e),n=100*(1-Math.pow(s,2)),o=Date.now()-m;if(o-d>100){const i=e/o;a.setCheckingProgress(n,`Difficulty: ${t}, Speed: ${i.toFixed(3)}kH/s`,s<.01?"This is taking longer than expected. Please do not refresh the page.":void 0),d=o}})),y=Date.now();console.log({hash:p,solution:g}),a.setState("success",{status:"Verification Complete!",metrics:`Took ${y-m}ms, ${g} iterations`});const w=function(e,t,s,n,a,o,i){const c=document.createElement("form");c.method="POST",c.action=`${s}/answer`;const r=document.createElement("input");r.type="hidden",r.name="response",r.value=e;const l=document.createElement("input");l.type="hidden",l.name="solution",l.value=t;const m=document.createElement("input");m.type="hidden",m.name="nonce",m.value=n;const d=document.createElement("input");d.type="hidden",d.name="ts",d.value=a;const u=document.createElement("input");u.type="hidden",u.name="signature",u.value=o;const h=document.createElement("input");h.type="hidden",h.name="data",h.value=i;const p=document.createElement("input");return p.type="hidden",p.name="redir",p.value=window.location.href,c.appendChild(r),c.appendChild(l),c.appendChild(m),c.appendChild(d),c.appendChild(u),c.appendChild(h),c.appendChild(p),document.body.appendChild(c),c}(p,g,o,c,r,l,C);setTimeout((()=>{w.submit()}),250)})()}}]);